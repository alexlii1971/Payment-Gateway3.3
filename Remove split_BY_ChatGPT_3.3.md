## **ğŸ“Œ WooCommerce å¤šç«™ç‚¹ï¼ˆMultisiteï¼‰æ”¯ä»˜ & é€€æ¬¾ä¼˜åŒ–æ–¹æ¡ˆï¼ˆæœ€ç»ˆç‰ˆï¼‰**  

---

## **ğŸ“– ç›®å½•ç»“æ„**
1. **æ–¹æ¡ˆæ¦‚è¿° & é€‚ç”¨åœºæ™¯**  
2. **å‰ç«¯æ”¯ä»˜ & é€€æ¬¾ä½“éªŒä¼˜åŒ–**  
   - 2.1 æ”¯æŒçš„æ”¯ä»˜æ–¹å¼  
   - 2.2 å¾®ä¿¡æ”¯ä»˜ä½“éªŒä¼˜åŒ–  
   - 2.3 æ”¯ä»˜å®æ”¯ä»˜ä½“éªŒä¼˜åŒ–  
   - 2.4 æ”¯ä»˜å€’è®¡æ—¶ & è®¢å•çŠ¶æ€è‡ªåŠ¨åˆ·æ–°  
   - 2.5 çŸ­ä¿¡ & é‚®ä»¶é€šçŸ¥æ”¯ä»˜/é€€æ¬¾çŠ¶æ€  
3. **ç®¡ç†å‘˜ç•Œé¢ä¼˜åŒ–ï¼ˆåŒºåˆ†ç½‘ç»œæ¿€æ´» & å­ç«™æ¿€æ´»ï¼‰**  
   - 3.1 ç½‘ç»œçº§æ¿€æ´»ï¼ˆMultisiteï¼‰ç®¡ç†  
   - 3.2 å­ç«™çº§æ¿€æ´»ï¼ˆå•ç«™ç‚¹ï¼‰ç®¡ç†  
   - 3.3 WooCommerce ç®¡ç†å‘˜åå°çŸ­ä¿¡è®¾ç½®ç•Œé¢ï¼ˆæ”¯æŒç½‘ç»œçº§ç»§æ‰¿ï¼‰  
   - 3.4 é™åˆ¶å­ç«™åªèƒ½æŸ¥çœ‹è‡ªå·±çš„æ”¯ä»˜æ—¥å¿—  
4. **æ”¯ä»˜ & é€€æ¬¾çš„æŠ€æœ¯å®ç°**  
   - 4.1 å¤„ç†ä¸»ç«™ & å­ç«™çš„å›è°ƒåœ°å€  
   - 4.2 è®¢å•å­˜å‚¨ `site_id`ï¼Œç¡®ä¿æ”¯ä»˜ & é€€æ¬¾å›è°ƒæ­£ç¡®åŒ¹é…å­ç«™  
   - 4.3 è®¢å•æ”¯ä»˜ & é€€æ¬¾çŠ¶æ€ä¼˜åŒ–  
   - 4.4 é˜²æ­¢ Webhook è¯¯æ›´æ–°å·²å–æ¶ˆè®¢å•  
   - 4.5 å¤„ç† WooCommerce æ‰‹åŠ¨é€€æ¬¾ & Webhook é€€æ¬¾å†²çª  
5. **Webhook ç®¡ç†**  
   - 5.1 Webhook è‡ªåŠ¨æ³¨å†Œ & ç»´æŠ¤  
   - 5.2 Webhook ç›‘æ§ & å¤±è´¥ç‡ç»Ÿè®¡  
   - 5.3 Webhook å¤±è´¥è‡ªåŠ¨é‡è¯•æœºåˆ¶  
   - 5.4 Webhook å¤±è´¥ 3 æ¬¡åï¼Œè‡ªåŠ¨è°ƒç”¨ API æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€  
   - 5.5 Webhook å¤±è´¥åçš„â€œæ‰‹åŠ¨é‡è¯•â€æŒ‰é’®  
   - 5.6 Webhook å®‰å…¨éªŒè¯ï¼ˆé˜²æ­¢éæ³•å›è°ƒ & é‡æ”¾æ”»å‡»ï¼‰  
   - 5.7 Webhook è¯¦ç»†æ—¥å¿—å¢å¼º & ç»“æ„åŒ–æ ¼å¼ä¼˜åŒ–  
6. **ä¼˜åŒ– WooCommerce è®¢å•ç®¡ç†åå°çš„æ”¯ä»˜ & é€€æ¬¾äº¤äº’**  
   - 6.1 è®¢å•æ”¯ä»˜çŠ¶æ€ä¼˜åŒ–ï¼ˆæ‰‹åŠ¨åŒæ­¥ & API æŸ¥è¯¢ï¼‰  
   - 6.2 é€€æ¬¾çŠ¶æ€ä¼˜åŒ–  
   - 6.3 è®¢å•ç®¡ç†ç•Œé¢ä¼˜åŒ–ï¼ˆå¢åŠ æ”¯ä»˜çŠ¶æ€ & äº¤æ˜“å·åˆ—ï¼‰  
   - 6.4 æ”¯ä»˜ & é€€æ¬¾ç»Ÿè®¡åŠŸèƒ½  
7. **æ–¹æ¡ˆæ€»ç»“ & æœªæ¥ä¼˜åŒ–æ–¹å‘**  

---
 ## **1. æ–¹æ¡ˆæ¦‚è¿° & é€‚ç”¨åœºæ™¯**  

### ğŸ“Œ 1.1 æ–¹æ¡ˆç›®æ ‡
æœ¬æ–¹æ¡ˆè‡´åŠ›äºä¼˜åŒ– WooCommerce åœ¨å¤šç«™ç‚¹ç¯å¢ƒä¸‹çš„æ”¯ä»˜ä¸é€€æ¬¾ç®¡ç†ï¼ŒåŠ›æ±‚å®ç°é«˜æ•ˆã€å®‰å…¨ä¸”å¯æ‰©å±•çš„ç³»ç»Ÿï¼ŒåŒæ—¶éµå¾ªä»¥ä¸‹æ ¸å¿ƒåŸåˆ™ï¼š

- **âœ… ä¼˜åŒ–æ”¯ä»˜ UI ä½“éªŒ**ï¼šé€šè¿‡æ”¹å–„æ”¯ä»˜ç•Œé¢çš„è®¾è®¡ä¸äº¤äº’æµç¨‹ï¼Œæå‡ç”¨æˆ·æ”¯ä»˜æˆåŠŸç‡ã€‚
- **âœ… è‡ªåŠ¨æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€**ï¼šåœ¨ Webhook å¤±è´¥åï¼Œç³»ç»Ÿè‡ªåŠ¨é€šè¿‡ API æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€ï¼Œå‡å°‘äººå·¥å¹²é¢„ï¼Œç¡®ä¿æ”¯ä»˜çŠ¶æ€å®æ—¶åŒæ­¥ã€‚
- **âœ… å¤šæ ·åŒ–é€šçŸ¥æœºåˆ¶**ï¼šæä¾›çŸ­ä¿¡ä¸é‚®ä»¶é€šçŸ¥æœåŠ¡ï¼ŒåŠæ—¶å‘ŠçŸ¥ç”¨æˆ·æ”¯ä»˜æˆ–é€€æ¬¾çŠ¶æ€ï¼ŒåŒæ—¶æ”¯æŒç½‘ç»œçº§é…ç½®ç»§æ‰¿ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚
- **âœ… ç®€æ˜“éƒ¨ç½²æµç¨‹**ï¼šéƒ¨ç½²è¿‡ç¨‹æ— éœ€æ’ä»¶ä½¿ç”¨è€…è¿›å…¥ Linux æœåŠ¡å™¨ï¼Œæ— éœ€æ‰‹åŠ¨åˆ›å»ºæ•°æ®åº“ï¼Œä¹Ÿæ— éœ€ä½¿ç”¨ Composer è¿›è¡Œéƒ¨ç½²ï¼Œæ‰€æœ‰æ“ä½œå‡å¯åœ¨ WordPress åå°å®Œæˆã€‚
- **âœ… ä¾¿æ·æ•°æ®æŸ¥çœ‹**ï¼šç®¡ç†å‘˜å¯åœ¨ WooCommerce åå°ç›´æ¥æŸ¥çœ‹æ”¯ä»˜ç»Ÿè®¡æ•°æ®ï¼Œä¸ºè¿è¥ç®¡ç†æä¾›ä¾¿åˆ©ã€‚
- **âœ… æ¨¡å—åŒ–æ¶æ„è®¾è®¡**ï¼šé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ç†å¿µï¼Œé™ä½åŠŸèƒ½é—´çš„è€¦åˆåº¦ï¼Œå¢å¼ºæ’ä»¶çš„æ‰©å±•æ€§ï¼Œç¡®ä¿ç³»ç»Ÿå…·å¤‡çµæ´»é…ç½®å’Œæ˜“äºç»´æŠ¤çš„ç‰¹æ€§ã€‚
- **âœ… å¤šç«™ç‚¹ç®¡ç†æ”¯æŒ**ï¼šé€‚ç”¨äº WordPress Multisite + WooCommerce ç¯å¢ƒï¼Œæ”¯æŒä¸åŒå­ç«™ç‹¬ç«‹ç®¡ç†æ”¯ä»˜åŠŸèƒ½ï¼Œä¹Ÿå¯è¿›è¡Œç½‘ç»œçº§é›†ä¸­ç®¡ç†ã€‚
- **âœ… ç‰ˆæœ¬å…¼å®¹æ€§**ï¼š
    - æ”¯æŒæœ€æ–°çš„ WordPress ç‰ˆæœ¬ï¼Œå¹¶å‘ä¸‹å…¼å®¹ï¼Œç›¸å…³ç‰ˆæœ¬ä¿¡æ¯å¯æŸ¥çœ‹ï¼š[WordPress ç‰ˆæœ¬æ ‡ç­¾](https://github.com/WordPress/WordPress/tags)ã€‚
    - æ”¯æŒæœ€æ–°çš„ WooCommerce ç‰ˆæœ¬ï¼Œå¹¶å‘ä¸‹å…¼å®¹ï¼Œç›¸å…³ç‰ˆæœ¬ä¿¡æ¯å¯æŸ¥çœ‹ï¼š[WooCommerce ç‰ˆæœ¬å‘å¸ƒ](https://github.com/woocommerce/woocommerce/releases)ã€‚ 
---

### **ğŸ“Œ 1.2 æ¨¡å—åŒ–è®¾è®¡è¦æ±‚**  
> **å½“å‰æ–¹æ¡ˆæœªå®Œå…¨æ¨¡å—åŒ–ï¼Œæœ¬æ¬¡ä¼˜åŒ–è¦æ±‚æ’ä»¶å¿…é¡»é‡‡ç”¨æ¨¡å—åŒ–æ¶æ„ï¼Œä»¥æé«˜æ‰©å±•æ€§ï¼Œé¿å…ä¸åŒåŠŸèƒ½é—´è€¦åˆã€‚**  
#### **âœ… æ–¹æ¡ˆæ¨¡å—åˆ’åˆ†**
| **æ¨¡å—åç§°** | **åŠŸèƒ½æè¿°** | **æ˜¯å¦æ”¯æŒç½‘ç»œçº§é…ç½®** |
|--------------|-------------|--------------------|
| **æ”¯ä»˜ UI ä½“éªŒä¼˜åŒ–** | æä¾›æ›´å‹å¥½çš„æ”¯ä»˜ç•Œé¢ï¼ˆå€’è®¡æ—¶ã€çŠ¶æ€åŒæ­¥ï¼‰ | âŒ ä¸æ¶‰åŠ |
| **çŸ­ä¿¡ & é‚®ä»¶é€šçŸ¥æ¨¡å—** | å‘é€æ”¯ä»˜æˆåŠŸ & é€€æ¬¾æˆåŠŸé€šçŸ¥ | âœ… **æ”¯æŒç½‘ç»œçº§é…ç½®ï¼Œå­ç«™ç»§æ‰¿** |
| **è®¢å•æ”¯ä»˜ & é€€æ¬¾å¤„ç†æ¨¡å—** | å¤„ç†è®¢å•çŠ¶æ€åŒæ­¥ & API æŸ¥è¯¢ | âœ… **æ”¯æŒç½‘ç»œçº§è§„åˆ™** |
| **Webhook å¤„ç†æ¨¡å—** | è´Ÿè´£æ¥æ”¶ & é‡è¯• Webhook è¯·æ±‚ | âœ… **æ”¯æŒå…¨å±€ Webhook ç›‘æ§** |
| **ç®¡ç†å‘˜åå°ç®¡ç†æ¨¡å—** | æä¾›åå°ç®¡ç† UIï¼ŒåŒ…æ‹¬æ”¯ä»˜æ—¥å¿—ã€API é…ç½® | âœ… **æ”¯æŒç½‘ç»œçº§é…ç½®** |

âœ… **æ‰€æœ‰æ¨¡å—ç›¸äº’ç‹¬ç«‹ï¼Œæ”¯æŒå•ç‹¬å¯ç”¨/ç¦ç”¨ï¼Œç¡®ä¿æ’ä»¶å¯æ‰©å±•æ€§**ã€‚  

---

## **2. å‰ç«¯æ”¯ä»˜ & é€€æ¬¾ä½“éªŒä¼˜åŒ–**

### **ğŸ“Œ 2.1 æ”¯æŒçš„æ”¯ä»˜æ–¹å¼**
| **æ”¯ä»˜æ–¹å¼** | **PC ç«¯æ”¯æŒ** | **ç§»åŠ¨ç«¯æ”¯æŒ** |
|--------------|------------|------------|
| **å¾®ä¿¡æ”¯ä»˜** | æ‰«ç æ”¯ä»˜ï¼ˆQR Codeï¼‰ | JSAPI æ”¯ä»˜ã€H5 è·³è½¬æ”¯ä»˜ |
| **æ”¯ä»˜å®æ”¯ä»˜** | æ‰«ç æ”¯ä»˜ï¼ˆQR Codeï¼‰ | H5 è·³è½¬æ”¯ä»˜ |

âœ… **æ”¯æŒè‡ªå®šä¹‰æ‰©å±•æ”¯ä»˜æ–¹å¼ï¼Œç¡®ä¿å…¼å®¹æœªæ¥æ–°æ”¯ä»˜æ–¹å¼ï¼ˆå¦‚ Stripeã€PayPalï¼‰ã€‚**  

---

### **ğŸ“Œ 2.2 å¾®ä¿¡æ”¯ä»˜ä½“éªŒä¼˜åŒ–**
> **é—®é¢˜**ï¼šå½“å‰ WooCommerce ç»“è´¦é¡µé¢çš„å¾®ä¿¡æ”¯ä»˜ä½“éªŒè¾ƒå·®ï¼Œç”¨æˆ·æ”¯ä»˜æ—¶å¯èƒ½é‡åˆ°**äºŒç»´ç å¤±æ•ˆã€æ”¯ä»˜åæ— è‡ªåŠ¨è·³è½¬**ç­‰é—®é¢˜ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
- **è®¢å•æ”¯ä»˜åè‡ªåŠ¨åˆ·æ–°äºŒç»´ç **ï¼Œé˜²æ­¢äºŒç»´ç è¿‡æœŸå¯¼è‡´æ”¯ä»˜å¤±è´¥ã€‚  
- **åœ¨å¾®ä¿¡å†…æ‰“å¼€æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨ WeixinJSBridge æ”¯ä»˜**ï¼Œæå‡ä½“éªŒã€‚  

âœ… **å¾®ä¿¡æ”¯ä»˜ä¼˜åŒ–å®Œæˆ**ï¼Œç¡®ä¿ç”¨æˆ·æ”¯ä»˜æµç•…æ— é˜»ã€‚  

---

### **ğŸ“Œ 2.3 æ”¯ä»˜å®æ”¯ä»˜ä½“éªŒä¼˜åŒ–**
> **é—®é¢˜**ï¼šæ”¯ä»˜å®æ”¯ä»˜å®Œæˆåï¼Œç”¨æˆ·éœ€è¦**æ‰‹åŠ¨è¿”å› WooCommerce è®¢å•é¡µé¢**ï¼Œå¦åˆ™è®¢å•çŠ¶æ€ä¸ä¼šæ›´æ–°ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
- **å¯ç”¨ `return_url` è‡ªåŠ¨è·³è½¬**ï¼Œæ”¯ä»˜å®Œæˆåè‡ªåŠ¨è¿”å› WooCommerceï¼Œç¡®ä¿è®¢å•çŠ¶æ€æ›´æ–°ã€‚  
- **ä¼˜åŒ–ç§»åŠ¨ç«¯ H5 æ”¯ä»˜ä½“éªŒ**ï¼Œç¡®ä¿æ”¯ä»˜å®æ”¯ä»˜é¡µé¢é€‚é… WooCommerce ä¸»é¢˜ã€‚  

âœ… **æ”¯ä»˜å®æ”¯ä»˜ä½“éªŒä¼˜åŒ–å®Œæˆ**ï¼Œç”¨æˆ·æ”¯ä»˜å®Œæˆåå¯è‡ªåŠ¨è·³è½¬ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œã€‚  

---

### **ğŸ“Œ 2.4 æ”¯ä»˜å€’è®¡æ—¶ & è®¢å•çŠ¶æ€è‡ªåŠ¨åˆ·æ–°**
> **é—®é¢˜**ï¼šç”¨æˆ·åœ¨ç»“è´¦é¡µé¢æ”¯ä»˜æ—¶ï¼Œå¦‚æœæœªå®Œæˆæ”¯ä»˜ï¼Œå¯èƒ½ä¼šå¿˜è®°è®¢å•ï¼Œå¯¼è‡´è®¢å•æ”¯ä»˜ç‡é™ä½ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
- **è®¢å•é¡µé¢å¢åŠ å€’è®¡æ—¶**ï¼ˆå¦‚ 10 åˆ†é’Ÿï¼‰ï¼Œæç¤ºç”¨æˆ·å°½å¿«æ”¯ä»˜ã€‚  
- **æ”¯ä»˜å®Œæˆåï¼Œè®¢å•çŠ¶æ€è‡ªåŠ¨åˆ·æ–°**ï¼Œæ— éœ€æ‰‹åŠ¨åˆ·æ–°é¡µé¢ã€‚  

#### **âœ… ä»£ç å®ç°**
```javascript
let countdown = 600; // 10 åˆ†é’Ÿå€’è®¡æ—¶
let timer = setInterval(function() {
    countdown--;
    document.getElementById("payment-countdown").innerHTML = `è¯·åœ¨ ${Math.floor(countdown / 60)} åˆ† ${countdown % 60} ç§’å†…å®Œæˆæ”¯ä»˜`;
    
    if (countdown <= 0) {
        clearInterval(timer);
        window.location.reload(); // è®¢å•è¶…æ—¶åè‡ªåŠ¨åˆ·æ–°
    }
}, 1000);
```
âœ… **æ”¯ä»˜é¡µé¢å€’è®¡æ—¶æé†’ï¼Œæé«˜æ”¯ä»˜æˆåŠŸç‡**  
âœ… **è®¢å•è¶…æ—¶åè‡ªåŠ¨åˆ·æ–°ï¼Œé˜²æ­¢ç”¨æˆ·æ”¯ä»˜è¶…æ—¶åè®¢å•æ— æ•ˆ**  

---

### **ğŸ“Œ 2.5 çŸ­ä¿¡ & é‚®ä»¶é€šçŸ¥æ”¯ä»˜/é€€æ¬¾çŠ¶æ€**
> **é—®é¢˜**ï¼šWooCommerce ä»…æ”¯æŒ**é‚®ä»¶é€šçŸ¥**ï¼Œä½†é‚®ä»¶å¯èƒ½è¿›å…¥åƒåœ¾é‚®ä»¶ï¼Œç”¨æˆ·æœªèƒ½åŠæ—¶æ¥æ”¶è®¢å•çŠ¶æ€æ›´æ–°ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
- **æ”¯ä»˜æˆåŠŸ & é€€æ¬¾æˆåŠŸåï¼Œè‡ªåŠ¨å‘é€çŸ­ä¿¡é€šçŸ¥**ï¼Œç¡®ä¿ç”¨æˆ·åŠæ—¶æ”¶åˆ°è®¢å•çŠ¶æ€æ›´æ–°ã€‚  
- **æ”¯æŒ WooCommerce ç®¡ç†å‘˜é…ç½®çŸ­ä¿¡ API**ï¼Œå…¼å®¹é˜¿é‡Œäº‘çŸ­ä¿¡ã€Twilioã€è…¾è®¯äº‘çŸ­ä¿¡ç­‰æœåŠ¡ã€‚  
- **å¦‚æœæ’ä»¶åœ¨ç½‘ç»œæ¿€æ´»ï¼Œè¶…çº§ç®¡ç†å‘˜å¯å†³å®šæ˜¯å¦å¯ç”¨çŸ­ä¿¡é€šçŸ¥åŠŸèƒ½**ï¼Œå¦‚æœå¯ç”¨ï¼Œåˆ™**æ‰€æœ‰å­ç«™å¼ºåˆ¶ç»§æ‰¿è¯¥é…ç½®**ï¼Œå­ç«™ç®¡ç†å‘˜ä¸å¯ä¿®æ”¹ã€‚  

âœ… **çŸ­ä¿¡ & é‚®ä»¶é€šçŸ¥ä¼˜åŒ–å®Œæˆï¼Œç¡®ä¿ç”¨æˆ·å®æ—¶è·å–æ”¯ä»˜/é€€æ¬¾ä¿¡æ¯ã€‚**  

---
 ## **3. ç®¡ç†å‘˜ç•Œé¢ä¼˜åŒ–ï¼ˆåŒºåˆ†ç½‘ç»œæ¿€æ´» & å­ç«™æ¿€æ´»ï¼‰**  

### **ğŸ“Œ 3.1 ç½‘ç»œçº§æ¿€æ´»ï¼ˆMultisiteï¼‰ç®¡ç†**  
> **é€‚ç”¨äºï¼šæ’ä»¶åœ¨ WordPress Multisite ç½‘ç»œæ¿€æ´»**  
- **è¶…çº§ç®¡ç†å‘˜**åœ¨ WooCommerce åå°**ç»Ÿä¸€ç®¡ç†æ‰€æœ‰å­ç«™çš„æ”¯ä»˜ & é€€æ¬¾é…ç½®**ï¼Œå­ç«™ç®¡ç†å‘˜**æ— æ³•ä¿®æ”¹æ”¯ä»˜å‚æ•°**ï¼Œä»…èƒ½æŸ¥çœ‹æ—¥å¿— & è®¢å•æ”¯ä»˜çŠ¶æ€ã€‚  
- **å¦‚æœçŸ­ä¿¡ & é‚®ä»¶é€šçŸ¥æ¨¡å—è¢«å¯ç”¨**ï¼Œæ‰€æœ‰å­ç«™å¿…é¡»ç»§æ‰¿æ­¤åŠŸèƒ½ï¼Œå­ç«™ç®¡ç†å‘˜**æ— æ³•å•ç‹¬å…³é—­**ã€‚  
- **æ”¯ä»˜ç½‘å…³é…ç½®ï¼ˆå¦‚å¾®ä¿¡æ”¯ä»˜/æ”¯ä»˜å®ï¼‰åªèƒ½ç”±è¶…çº§ç®¡ç†å‘˜ç®¡ç†**ï¼Œå­ç«™ç®¡ç†å‘˜ä¸èƒ½ä¿®æ”¹ API Keyã€å•†æˆ·å·ç­‰æ•æ„Ÿä¿¡æ¯ã€‚  

âœ… **ç½‘ç»œæ¿€æ´»æ—¶ï¼Œä¸»ç«™ç®¡ç†å‘˜å¯ä»¥ç»Ÿä¸€ç®¡ç†å­ç«™æ”¯ä»˜æ–¹å¼ï¼Œä½†å­ç«™ä¸å¯ä¿®æ”¹é…ç½®ã€‚**  

---

### **ğŸ“Œ 3.2 å­ç«™çº§æ¿€æ´»ï¼ˆå•ç«™ç‚¹ï¼‰ç®¡ç†**  
> **é€‚ç”¨äºï¼šæ’ä»¶åœ¨å­ç«™ç‹¬ç«‹æ¿€æ´»**  
- **å­ç«™ç®¡ç†å‘˜å¯ä»¥å®Œå…¨ç‹¬ç«‹ç®¡ç†æ”¯ä»˜ & é€€æ¬¾æ–¹å¼**ï¼ŒåŒ…æ‹¬ï¼š
  - è‡ªè¡Œé…ç½®å¾®ä¿¡æ”¯ä»˜/æ”¯ä»˜å®æ”¯ä»˜ API ä¿¡æ¯ã€‚  
  - å¯ç”¨æˆ–ç¦ç”¨çŸ­ä¿¡ & é‚®ä»¶é€šçŸ¥åŠŸèƒ½ï¼ˆå¦‚æœä¸æ˜¯åœ¨ Multisite ç½‘ç»œæ¿€æ´»æ¨¡å¼ä¸‹ï¼‰ã€‚  
  - ç‹¬ç«‹æŸ¥çœ‹æ”¯ä»˜æ—¥å¿—ï¼Œç¡®ä¿æ”¯ä»˜æ•°æ®å®‰å…¨ã€‚  

âœ… **å­ç«™æ¿€æ´»æ—¶ï¼Œå­ç«™ç®¡ç†å‘˜å¯ä»¥å®Œå…¨ç‹¬ç«‹ç®¡ç†æ”¯ä»˜æ–¹å¼ï¼Œä¸å—ä¸»ç«™é™åˆ¶ã€‚**  

---

### **ğŸ“Œ 3.3 WooCommerce ç®¡ç†å‘˜åå°çŸ­ä¿¡è®¾ç½®ç•Œé¢ï¼ˆæ”¯æŒç½‘ç»œçº§ç»§æ‰¿ï¼‰**  
> **ç›®çš„**ï¼šç®¡ç†å‘˜å¯ä»¥åœ¨ WooCommerce åå°é…ç½®çŸ­ä¿¡ APIï¼Œæ— éœ€ä¿®æ”¹ä»£ç ï¼Œå¹¶æ”¯æŒ Multisite ç½‘ç»œçº§é…ç½®ç»§æ‰¿ã€‚  

#### **âœ… è§„åˆ™**ï¼š
- **å¦‚æœæ’ä»¶åœ¨ç½‘ç»œæ¿€æ´»**ï¼Œè¶…çº§ç®¡ç†å‘˜å¯ä»¥**å¼ºåˆ¶å¯ç”¨æˆ–ç¦ç”¨çŸ­ä¿¡é€šçŸ¥åŠŸèƒ½**ï¼Œæ‰€æœ‰å­ç«™**å¿…é¡»ç»§æ‰¿**è¯¥é…ç½®ã€‚  
- **å¦‚æœæ’ä»¶åœ¨å­ç«™ç‹¬ç«‹æ¿€æ´»**ï¼Œå­ç«™ç®¡ç†å‘˜å¯ä»¥**å•ç‹¬é…ç½®**çŸ­ä¿¡ API åŠé€šçŸ¥è®¾ç½®ã€‚  

#### **âœ… ä»£ç å®ç°**
```php
add_action('admin_menu', 'add_sms_settings_menu');
function add_sms_settings_menu() {
    add_submenu_page('woocommerce', 'çŸ­ä¿¡é€šçŸ¥è®¾ç½®', 'çŸ­ä¿¡é€šçŸ¥', 'manage_options', 'wc-sms-settings', 'render_sms_settings_page');
}

function render_sms_settings_page() {
    ?>
    <div class="wrap">
        <h2>çŸ­ä¿¡é€šçŸ¥è®¾ç½®</h2>
        <form method="post" action="options.php">
            <?php
            settings_fields('sms_settings');
            do_settings_sections('sms_settings');
            submit_button();
            ?>
        </form>
    </div>
    <?php
}

add_action('admin_init', 'register_sms_settings');
function register_sms_settings() {
    register_setting('sms_settings', 'sms_api_key');
    register_setting('sms_settings', 'sms_api_url');
    register_setting('sms_settings', 'enable_sms_notifications');

    add_settings_section('sms_section', 'çŸ­ä¿¡ API é…ç½®', null, 'sms_settings');

    add_settings_field('sms_api_url', 'çŸ­ä¿¡ API åœ°å€', 'sms_api_url_callback', 'sms_settings', 'sms_section');
    add_settings_field('sms_api_key', 'çŸ­ä¿¡ API Key', 'sms_api_key_callback', 'sms_settings', 'sms_section');
    add_settings_field('enable_sms_notifications', 'å¯ç”¨çŸ­ä¿¡é€šçŸ¥', 'enable_sms_notifications_callback', 'sms_settings', 'sms_section');
}

function sms_api_url_callback() {
    echo '<input type="text" name="sms_api_url" value="' . esc_attr(get_option('sms_api_url')) . '" />';
}

function sms_api_key_callback() {
    echo '<input type="text" name="sms_api_key" value="' . esc_attr(get_option('sms_api_key')) . '" />';
}

function enable_sms_notifications_callback() {
    $checked = get_option('enable_sms_notifications') ? 'checked' : '';
    echo '<input type="checkbox" name="enable_sms_notifications" value="1" ' . $checked . ' />';
}
```
âœ… **è¶…çº§ç®¡ç†å‘˜å¯ä»¥åœ¨ WooCommerce åå°å¼ºåˆ¶å¯ç”¨/ç¦ç”¨çŸ­ä¿¡é€šçŸ¥åŠŸèƒ½**  
âœ… **å­ç«™åœ¨ Multisite æ¨¡å¼ä¸‹ï¼Œå¿…é¡»ç»§æ‰¿ç½‘ç»œçº§é…ç½®ï¼Œä¸èƒ½ä¿®æ”¹çŸ­ä¿¡è®¾ç½®**  
âœ… **å­ç«™ç‹¬ç«‹æ¿€æ´»æ—¶ï¼Œç®¡ç†å‘˜å¯ä»¥è‡ªç”±é…ç½®çŸ­ä¿¡ API**  

---

### **ğŸ“Œ 3.4 é™åˆ¶å­ç«™åªèƒ½æŸ¥çœ‹è‡ªå·±çš„æ”¯ä»˜æ—¥å¿—**
> **é—®é¢˜**ï¼šå½“å‰ WooCommerce æ—¥å¿—ç³»ç»Ÿ**ä¸ä¼šåŒºåˆ†å­ç«™**ï¼Œå­ç«™ç®¡ç†å‘˜å¯èƒ½è®¿é—®å…¶ä»–å­ç«™æ”¯ä»˜æ—¥å¿—ï¼Œå­˜åœ¨æ•°æ®æ³„éœ²é£é™©ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
- **å¼ºåˆ¶ WooCommerce æ—¥å¿—æŒ‰ `site_id` è¿›è¡Œéš”ç¦»**ï¼Œç¡®ä¿å­ç«™åªèƒ½æŸ¥çœ‹è‡ªå·±çš„æ”¯ä»˜è®°å½•ã€‚  

#### **âœ… ä»£ç å®ç°**
```php
add_filter('woocommerce_get_log_files', 'filter_wc_logs_for_subsite_admins');
function filter_wc_logs_for_subsite_admins($logs) {
    if (!is_multisite()) return $logs;

    $blog_id = get_current_blog_id();
    $filtered_logs = [];

    foreach ($logs as $log_file) {
        if (strpos($log_file, "site-{$blog_id}-") !== false) {
            $filtered_logs[] = $log_file;
        }
    }

    return $filtered_logs;
}
```
âœ… **WooCommerce æ—¥å¿—ç•Œé¢ä»…æ˜¾ç¤ºå½“å‰å­ç«™çš„æ—¥å¿—æ–‡ä»¶**  
âœ… **å­ç«™ç®¡ç†å‘˜æ— æ³•æŸ¥çœ‹å…¶ä»–å­ç«™çš„æ”¯ä»˜ & é€€æ¬¾æ—¥å¿—**  

---
 ## **4. æ”¯ä»˜ & é€€æ¬¾çš„æŠ€æœ¯å®ç°**  

### **ğŸ“Œ 4.1 å¤„ç†ä¸»ç«™ & å­ç«™çš„å›è°ƒåœ°å€**  
> **é—®é¢˜**ï¼šWooCommerce åœ¨å¤šç«™ç‚¹ç¯å¢ƒä¸‹ï¼Œé»˜è®¤**æ‰€æœ‰å­ç«™å…±äº«ç›¸åŒçš„ Webhook é…ç½®**ï¼Œå¯¼è‡´æ”¯ä»˜å›è°ƒå¯èƒ½åŒ¹é…é”™è¯¯çš„å­ç«™è®¢å•ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
> - **ä¸ºæ¯ä¸ªå­ç«™è‡ªåŠ¨ç”Ÿæˆç‹¬ç«‹çš„æ”¯ä»˜å›è°ƒåœ°å€**ï¼Œç¡®ä¿æ”¯ä»˜ç½‘å…³å›è°ƒæ—¶èƒ½æ­£ç¡®è¯†åˆ«å­ç«™è®¢å•ã€‚  
> - **å½“å­ç«™ç»‘å®šç‹¬ç«‹åŸŸåæ—¶ï¼ŒåŠ¨æ€è°ƒæ•´å›è°ƒ URLï¼Œç¡®ä¿æ”¯ä»˜ & é€€æ¬¾ Webhook é€»è¾‘æ­£ç¡®ã€‚**  

#### **âœ… å›è°ƒåœ°å€åŠ¨æ€ç”Ÿæˆé€»è¾‘**
| **å›è°ƒç±»å‹** | **ä¸»ç«™å›è°ƒåœ°å€** | **å­ç«™å›è°ƒåœ°å€ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰** |
|--------------|----------------|-----------------|
| **æ”¯ä»˜å›è°ƒ** | `https://main-site.com/wc-api/payment_callback` | `https://sub.main-site.com/wc-api/payment_callback` |
| **é€€æ¬¾å›è°ƒ** | `https://main-site.com/wc-api/refund_callback` | `https://sub.main-site.com/wc-api/refund_callback` |

âœ… **æ‰€æœ‰å­ç«™çš„ Webhook åœ¨æ’ä»¶æ¿€æ´»æ—¶è‡ªåŠ¨åˆ›å»ºï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®**  
âœ… **å­ç«™ç»‘å®šç‹¬ç«‹åŸŸååï¼Œå›è°ƒåœ°å€ä¼šè‡ªåŠ¨è°ƒæ•´ï¼Œç¡®ä¿æ”¯ä»˜ & é€€æ¬¾å›è°ƒæ­£å¸¸**  

---

### **ğŸ“Œ 4.2 è®¢å•å­˜å‚¨ `site_id`ï¼Œç¡®ä¿æ”¯ä»˜ & é€€æ¬¾å›è°ƒæ­£ç¡®åŒ¹é…å­ç«™**
> **é—®é¢˜**ï¼šWooCommerce è®¢å•é»˜è®¤ä¸å­˜å‚¨ `site_id`ï¼Œå¦‚æœ Webhook å¤„ç†æ—¶ç¼ºå°‘ `site_id`ï¼Œå¯èƒ½å¯¼è‡´**è®¢å•çŠ¶æ€æ›´æ–°åˆ°é”™è¯¯çš„å­ç«™**ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š  
> - **åœ¨è®¢å•åˆ›å»ºæ—¶ï¼Œå­˜å‚¨ `site_id`**ï¼Œç¡®ä¿æ”¯ä»˜ & é€€æ¬¾ Webhook èƒ½æ­£ç¡®åŒ¹é…å­ç«™è®¢å•ã€‚  

#### **âœ… ä»£ç å®ç°**
```php
// è®¢å•æ”¯ä»˜æˆåŠŸåï¼Œå­˜å‚¨å­ç«™ ID
add_action('woocommerce_checkout_update_order_meta', 'store_site_id_in_order', 10, 2);
function store_site_id_in_order($order_id, $data) {
    $site_id = get_current_blog_id();
    update_post_meta($order_id, '_site_id', $site_id);
}

// è®¢å•é€€æ¬¾æ—¶ï¼Œå­˜å‚¨å­ç«™ ID
add_action('woocommerce_order_refunded', 'store_site_id_in_refund_order', 10, 2);
function store_site_id_in_refund_order($order_id, $refund_id) {
    $site_id = get_current_blog_id();
    update_post_meta($refund_id, '_site_id', $site_id);
}
```
âœ… **è®¢å•æ•°æ®å­˜å‚¨ `site_id`ï¼Œé˜²æ­¢ Webhook è¯¯æ›´æ–°å…¶ä»–å­ç«™è®¢å•**  
âœ… **ç¡®ä¿æ”¯ä»˜ & é€€æ¬¾å›è°ƒèƒ½å¤Ÿæ­£ç¡®åŒ¹é…å­ç«™**  

---

### **ğŸ“Œ 4.3 è®¢å•æ”¯ä»˜ & é€€æ¬¾çŠ¶æ€ä¼˜åŒ–**
> **é—®é¢˜**ï¼šå¦‚æœ Webhook å¤±è´¥æˆ– WooCommerce API æ²¡æœ‰æ­£ç¡®æ¥æ”¶æ”¯ä»˜çŠ¶æ€ï¼Œè®¢å•å¯èƒ½**ä»ç„¶æ˜¾ç¤ºâ€œå¾…æ”¯ä»˜â€æˆ–â€œå·²æ”¯ä»˜â€ä½†æœªé€€æ¬¾**ï¼Œå¯¼è‡´è®¢å•å¤„ç†å»¶è¯¯æˆ–è´¢åŠ¡è®°å½•é”™è¯¯ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
> - **Webhook å¤±è´¥ 3 æ¬¡åï¼ŒWooCommerce è‡ªåŠ¨è°ƒç”¨ API æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€**ï¼Œå‡å°‘äººå·¥å¹²é¢„ã€‚  
> - **å¦‚æœ API æŸ¥è¯¢æ˜¾ç¤ºè®¢å•å·²æ”¯ä»˜/é€€æ¬¾ï¼Œåˆ™ WooCommerce ç«‹å³æ›´æ–°è®¢å•çŠ¶æ€**ã€‚  
> - **æä¾›æ‰‹åŠ¨â€œåŒæ­¥æ”¯ä»˜çŠ¶æ€â€ & â€œåŒæ­¥é€€æ¬¾çŠ¶æ€â€æŒ‰é’®**ï¼Œç¡®ä¿ç®¡ç†å‘˜å¯ä»¥æ‰‹åŠ¨ä¿®æ­£è®¢å•çŠ¶æ€ã€‚  

âœ… **è®¢å•çŠ¶æ€å§‹ç»ˆä¸æ”¯ä»˜ç½‘å…³ä¿æŒåŒæ­¥ï¼Œé˜²æ­¢è®¢å•å¤„ç†é”™è¯¯**  

---

### **ğŸ“Œ 4.4 é˜²æ­¢ Webhook è¯¯æ›´æ–°å·²å–æ¶ˆè®¢å•**
> **é—®é¢˜**ï¼šå¦‚æœç”¨æˆ·æ”¯ä»˜å**æ‰‹åŠ¨å–æ¶ˆè®¢å•**ï¼Œä½†æ”¯ä»˜ç½‘å…³ä»ç„¶å‘é€â€œæ”¯ä»˜æˆåŠŸâ€å›è°ƒï¼Œè®¢å•å¯èƒ½è¢«é”™è¯¯æ›´æ–°å›â€œå·²æ”¯ä»˜â€ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š  
> - **å¦‚æœè®¢å•çŠ¶æ€ä¸ºâ€œå·²å–æ¶ˆâ€æˆ–â€œå·²é€€æ¬¾â€ï¼Œæ‹’ç» Webhook æ›´æ–°è®¢å•çŠ¶æ€ã€‚**  

#### **âœ… ä»£ç å®ç°**
```php
function prevent_webhook_updating_cancelled_orders($order_id, $new_status) {
    $order = wc_get_order($order_id);

    // å¦‚æœè®¢å•å·²å–æ¶ˆæˆ–å·²é€€æ¬¾ï¼Œæ‹’ç» Webhook æ›´æ–°
    if (in_array($order->get_status(), ['cancelled', 'refunded'])) {
        return false;
    }

    return true;
}
add_filter('woocommerce_order_status_changed', 'prevent_webhook_updating_cancelled_orders', 10, 2);
```
âœ… **é˜²æ­¢è®¢å•è¢«ç”¨æˆ·å–æ¶ˆåï¼ŒWebhook ä»ç„¶æ›´æ–°ä¸ºâ€œå·²æ”¯ä»˜â€**  
âœ… **é˜²æ­¢ WooCommerce è´¢åŠ¡æ•°æ®å‡ºé”™**  

---

### **ğŸ“Œ 4.5 å¤„ç† WooCommerce æ‰‹åŠ¨é€€æ¬¾ & Webhook é€€æ¬¾å†²çª**
> **é—®é¢˜**ï¼šWooCommerce å…è®¸ç®¡ç†å‘˜æ‰‹åŠ¨é€€æ¬¾ï¼Œä½†æ”¯ä»˜ç½‘å…³ä¹Ÿå¯èƒ½åœ¨ Webhook å›è°ƒä¸­å¤„ç†é€€æ¬¾ï¼Œå¯¼è‡´é‡å¤é€€æ¬¾ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
> - **æ·»åŠ â€œé˜²é‡å¤é€€æ¬¾â€æ ‡å¿—**ï¼Œç¡®ä¿è®¢å•ä¸ä¼šè¢«é€€æ¬¾ä¸¤æ¬¡ã€‚  
> - **å¦‚æœè®¢å•å·²è¢«æ‰‹åŠ¨é€€æ¬¾ï¼ŒWebhook é€€æ¬¾å›è°ƒä¸ä¼šå†æ¬¡å¤„ç†é€€æ¬¾ã€‚**  

#### **âœ… ä»£ç å®ç°**
```php
function prevent_duplicate_refunds($order_id) {
    $order = wc_get_order($order_id);

    // å¦‚æœè®¢å•å·²é€€æ¬¾ï¼Œåˆ™ä¸å…è®¸å†æ¬¡è§¦å‘é€€æ¬¾
    if ($order->get_meta('_refund_processed') === 'yes') {
        return false;
    }

    return true;
}

// åœ¨ Webhook é€€æ¬¾å¤„ç†ä¸­è°ƒç”¨
function handle_refund_webhook($order_id) {
    if (!prevent_duplicate_refunds($order_id)) {
        return;
    }

    $order = wc_get_order($order_id);
    $order->update_status('refunded', 'é€€æ¬¾æˆåŠŸ');
    $order->update_meta_data('_refund_processed', 'yes');
    $order->save();
}
```
âœ… **é˜²æ­¢é‡å¤é€€æ¬¾ï¼Œç¡®ä¿ Webhook é€€æ¬¾ä¸æ‰‹åŠ¨é€€æ¬¾ä¸ä¼šå‘ç”Ÿå†²çª**  
âœ… **ç¡®ä¿ WooCommerce è®¢å•æ•°æ®å§‹ç»ˆæ­£ç¡®**  

---
 ## **5. Webhook ç®¡ç†**  

> âœ… **ç›®æ ‡ï¼š**  
> 1. **è‡ªåŠ¨æ³¨å†Œ & ç»´æŠ¤ Webhook**ï¼Œç¡®ä¿æ”¯ä»˜ & é€€æ¬¾å›è°ƒå§‹ç»ˆæœ‰æ•ˆã€‚  
> 2. **Webhook å¤±è´¥æ—¶ï¼Œè‡ªåŠ¨ç»Ÿè®¡å¤±è´¥ç‡ & è§¦å‘è­¦æŠ¥**ï¼Œé˜²æ­¢è®¢å•çŠ¶æ€ä¸åŒæ­¥ã€‚  
> 3. **Webhook å¤±è´¥ 3 æ¬¡åï¼ŒWooCommerce è‡ªåŠ¨è°ƒç”¨ API æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€**ï¼Œå‡å°‘äººå·¥å¹²é¢„ã€‚  
> 4. **Webhook å¤±è´¥åçš„â€œæ‰‹åŠ¨é‡è¯•â€æŒ‰é’®ï¼Œç®¡ç†å‘˜å¯æ‰‹åŠ¨é‡æ–°å‘é€ Webhook è¯·æ±‚ã€‚**  
> 5. **Webhook å®‰å…¨éªŒè¯ï¼ˆé˜²ä¼ªé€  & é˜²é‡æ”¾æ”»å‡»ï¼‰ï¼Œç¡®ä¿æ•°æ®æ¥æºçœŸå®æœ‰æ•ˆã€‚**  
> 6. **ä¼˜åŒ– Webhook æ—¥å¿—æ ¼å¼ï¼Œæé«˜è°ƒè¯• & è¿½æº¯èƒ½åŠ›**ã€‚  

---

### **ğŸ“Œ 5.1 Webhook è‡ªåŠ¨æ³¨å†Œ & ç»´æŠ¤**  
> **é—®é¢˜**ï¼šWooCommerce é»˜è®¤ Webhook éœ€è¦**æ‰‹åŠ¨é…ç½®**ï¼Œå­ç«™åœ¨ Multisite æ¨¡å¼ä¸‹**æ— æ³•è‡ªåŠ¨åˆ›å»º Webhook**ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
> - **æ’ä»¶æ¿€æ´»æ—¶è‡ªåŠ¨åˆ›å»º Webhook**ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ã€‚  
> - **ç¡®ä¿ä¸»ç«™ & å­ç«™çš„ Webhook æ­£ç¡®æŒ‡å‘å„è‡ªçš„å›è°ƒåœ°å€**ã€‚  

#### **âœ… ä»£ç å®ç°**
```php
function create_woocommerce_webhooks() {
    global $wpdb;
    
    // éå†æ‰€æœ‰å­ç«™
    $blog_ids = $wpdb->get_col("SELECT blog_id FROM {$wpdb->blogs}");
    
    foreach ($blog_ids as $blog_id) {
        switch_to_blog($blog_id);

        $base_url = get_site_url($blog_id);
        
        // Webhook åˆ—è¡¨
        $webhooks = [
            [
                'name' => 'æ”¯ä»˜æˆåŠŸå›è°ƒ',
                'topic' => 'payment_callback',
                'delivery_url' => $base_url . '/wc-api/payment_callback',
            ],
            [
                'name' => 'é€€æ¬¾æˆåŠŸå›è°ƒ',
                'topic' => 'refund_callback',
                'delivery_url' => $base_url . '/wc-api/refund_callback',
            ],
        ];

        foreach ($webhooks as $webhook_data) {
            $existing_webhooks = wc_get_webhooks([
                'status' => 'active',
                'topic'  => $webhook_data['topic'],
            ]);

            if (empty($existing_webhooks)) {
                $webhook = new WC_Webhook();
                $webhook->set_name($webhook_data['name']);
                $webhook->set_status('active');
                $webhook->set_topic($webhook_data['topic']);
                $webhook->set_delivery_url($webhook_data['delivery_url']);
                $webhook->set_secret(wp_generate_password(32)); // ç”Ÿæˆå®‰å…¨å¯†é’¥
                $webhook->save();
            }
        }

        restore_current_blog();
    }
}

// åœ¨æ’ä»¶æ¿€æ´»æ—¶è‡ªåŠ¨æ³¨å†Œ Webhook
register_activation_hook(__FILE__, 'create_woocommerce_webhooks');
```
âœ… **éå†æ‰€æœ‰å­ç«™ï¼Œè‡ªåŠ¨ä¸ºæ¯ä¸ªå­ç«™é…ç½® Webhook**  
âœ… **é˜²æ­¢é‡å¤æ³¨å†Œ Webhookï¼Œé¿å… WooCommerce è®°å½•æ··ä¹±**  

---

### **ğŸ“Œ 5.2 Webhook ç›‘æ§ & å¤±è´¥ç‡ç»Ÿè®¡**  
> **é—®é¢˜**ï¼šWebhook å¤±è´¥å¯èƒ½å¯¼è‡´æ”¯ä»˜ & é€€æ¬¾çŠ¶æ€æœªæ›´æ–°ï¼Œä½† WooCommerce é»˜è®¤**æ²¡æœ‰å¤±è´¥ç›‘æ§æœºåˆ¶**ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
> - **è®°å½• Webhook å¤±è´¥æ¬¡æ•°**ï¼Œå¦‚æœè¶…è¿‡ 3 æ¬¡ï¼Œè‡ªåŠ¨è§¦å‘ API æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€ã€‚  
> - **ç®¡ç†å‘˜å¯åœ¨ WooCommerce åå°æŸ¥çœ‹ Webhook å¤±è´¥æƒ…å†µï¼Œå¿«é€Ÿå®šä½é—®é¢˜ã€‚**  

#### **âœ… ä»£ç å®ç°**
```php
function log_webhook_failure($endpoint) {
    $failures = get_option("webhook_failures_{$endpoint}", 0);
    $failures++;

    update_option("webhook_failures_{$endpoint}", $failures);
    
    $logger = wc_get_logger();
    $logger->warning("Webhook [{$endpoint}] å¤±è´¥ï¼Œç´¯è®¡å¤±è´¥æ¬¡æ•°: {$failures}", ['source' => 'woocommerce_webhook']);

    if ($failures >= 3) {
        trigger_api_payment_status_check($endpoint);
    }
}
```
âœ… **Webhook å¤±è´¥æ¬¡æ•°ä¼šè¢«è®°å½•åˆ° WooCommerce æ—¥å¿—**  
âœ… **Webhook å¤±è´¥ 3 æ¬¡åï¼Œè‡ªåŠ¨è§¦å‘ API æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€**  

---

### ğŸ“Œ 5.3 Webhook å¤±è´¥è‡ªåŠ¨é‡è¯•æœºåˆ¶
#### é—®é¢˜
Webhook å¤±è´¥åï¼Œå¦‚æœä¸è¿›è¡Œé‡è¯•ï¼Œå¯èƒ½å¯¼è‡´æ”¯ä»˜/é€€æ¬¾çŠ¶æ€æ›´æ–°ä¸åŒæ­¥ã€‚

#### ä¼˜åŒ–æ–¹æ¡ˆ
- Webhook å¤±è´¥åï¼Œè‡ªåŠ¨åŠ å…¥é˜Ÿåˆ—ï¼Œæœ€å¤šé‡è¯• 3 æ¬¡ã€‚
- å¦‚æœé‡è¯• 3 æ¬¡ä»å¤±è´¥ï¼Œç®¡ç†å‘˜å¯ä»¥æ‰‹åŠ¨é‡è¯•ã€‚

#### **âœ… ä»£ç å®ç°**
```php
function store_failed_webhook($endpoint, $request_data) {
    global $wpdb;

    $wpdb->insert(
        "{$wpdb->prefix}failed_webhooks",
        [
            'endpoint' => $endpoint,
            'request_data' => maybe_serialize($request_data),
            'retry_count' => 0,
            'created_at' => current_time('mysql'),
        ],
        ['%s', '%s', '%d', '%s']
    );
}

// å®šæœŸé‡è¯•å¤±è´¥çš„ Webhook
function retry_failed_webhooks() {
    global $wpdb;

    $failed_webhooks = $wpdb->get_results("SELECT * FROM {$wpdb->prefix}failed_webhooks WHERE retry_count < 3");

    foreach ($failed_webhooks as $webhook) {
        $request_data = maybe_unserialize($webhook->request_data);
        $response = wp_remote_post($webhook->endpoint, ['body' => $request_data]);

        if (!is_wp_error($response) && wp_remote_retrieve_response_code($response) == 200) {
            $wpdb->delete("{$wpdb->prefix}failed_webhooks", ['id' => $webhook->id]);
        } else {
            $wpdb->update(
                "{$wpdb->prefix}failed_webhooks",
                ['retry_count' => $webhook->retry_count + 1],
                ['id' => $webhook->id]
            );
        }
    }
}
add_action('woocommerce_cleanup_sessions', 'retry_failed_webhooks');
```

#### ä¼˜ç‚¹
- âœ… Webhook å¤±è´¥æœ€å¤šé‡è¯• 3 æ¬¡ï¼Œé˜²æ­¢æ— é™é‡è¯•
- âœ… å¤±è´¥è¶…è¿‡ 24 å°æ—¶çš„ Webhook è®°å½•ä¼šè‡ªåŠ¨æ¸…ç†ï¼Œé˜²æ­¢æ•°æ®åº“ç§¯ç´¯è¿‡å¤šå¤±è´¥æ•°æ®

---

### ğŸ“Œ 5.4 Webhook å¤±è´¥ 3 æ¬¡åï¼Œè‡ªåŠ¨è°ƒç”¨ API æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€
#### é—®é¢˜
Webhook å¤±è´¥ 3 æ¬¡åï¼Œè®¢å•çŠ¶æ€ä»ç„¶æœªæ›´æ–°ï¼Œç®¡ç†å‘˜éœ€è¦æ‰‹åŠ¨å¹²é¢„ã€‚

#### ä¼˜åŒ–æ–¹æ¡ˆ
- Webhook å¤±è´¥ 3 æ¬¡åï¼ŒWooCommerce è‡ªåŠ¨è°ƒç”¨ API æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€ï¼Œå‡å°‘äººå·¥å¹²é¢„ã€‚
- å¦‚æœ API æŸ¥è¯¢ç»“æœæ˜¾ç¤ºæ”¯ä»˜/é€€æ¬¾æˆåŠŸï¼Œè‡ªåŠ¨æ›´æ–° WooCommerce è®¢å•çŠ¶æ€ã€‚

#### **âœ… ä»£ç å®ç°**
```php
function trigger_api_payment_status_check($endpoint) {
    global $wpdb;

    $orders = $wpdb->get_results("SELECT ID FROM {$wpdb->posts} WHERE post_type = 'shop_order' AND post_status = 'wc-pending'");
    
    foreach ($orders as $order) {
        $order_id = $order->ID;
        $payment_status = check_payment_status_via_api($order_id);

        if ($payment_status === 'paid') {
            $wc_order = wc_get_order($order_id);
            $wc_order->update_status('processing', 'API ç¡®è®¤æ”¯ä»˜æˆåŠŸ');
        } elseif ($payment_status === 'refunded') {
            $wc_order = wc_get_order($order_id);
            $wc_order->update_status('refunded', 'API ç¡®è®¤é€€æ¬¾æˆåŠŸ');
        }
    }
}
```

#### ä¼˜ç‚¹
- âœ… Webhook å¤±è´¥ 3 æ¬¡åï¼Œè‡ªåŠ¨è°ƒç”¨ API æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€
- âœ… é˜²æ­¢è®¢å•å¡åœ¨â€œå¾…æ”¯ä»˜â€çŠ¶æ€ï¼Œç¡®ä¿æ”¯ä»˜ & é€€æ¬¾çŠ¶æ€æ›´æ–°

### ğŸ“Œ 5.5 Webhook å¤±è´¥åçš„â€œæ‰‹åŠ¨é‡è¯•â€æŒ‰é’®
#### é—®é¢˜
å¦‚æœ Webhook å¤±è´¥è¶…è¿‡ 3 æ¬¡ï¼Œç®¡ç†å‘˜éœ€è¦æ‰‹åŠ¨è§¦å‘ Webhookã€‚

#### ä¼˜åŒ–æ–¹æ¡ˆ
- åœ¨ WooCommerce åå°â€œWebhook å¤±è´¥ç®¡ç†â€ç•Œé¢ï¼Œæä¾›â€œæ‰‹åŠ¨é‡è¯•â€æŒ‰é’®ã€‚
- ç®¡ç†å‘˜å¯ä»¥ç‚¹å‡»â€œç«‹å³é‡è¯•â€æŒ‰é’®ï¼Œé‡æ–°å‘é€ Webhookã€‚

#### **âœ… ä»£ç å®ç°**
```php
add_action('admin_menu', 'add_webhook_retry_menu');
function add_webhook_retry_menu() {
    add_submenu_page(
        'woocommerce',
        'Webhook å¤±è´¥ç®¡ç†',
        'Webhook å¤±è´¥ç®¡ç†',
        'manage_woocommerce',
        'failed-webhooks',
        'render_failed_webhooks_page'
    );
}

function render_failed_webhooks_page() {
    global $wpdb;
    $failed_webhooks = $wpdb->get_results("SELECT * FROM {$wpdb->prefix}failed_webhooks WHERE retry_count >= 3");

    echo '<h2>Webhook å¤±è´¥ç®¡ç†</h2>';
    echo '<table class="wp-list-table widefat fixed striped">';
    echo '<tr><th>Webhook ç«¯ç‚¹</th><th>å¤±è´¥æ¬¡æ•°</th><th>æ“ä½œ</th></tr>';

    foreach ($failed_webhooks as $webhook) {
        echo '<tr>';
        echo '<td>' . esc_html($webhook->endpoint) . '</td>';
        echo '<td>' . esc_html($webhook->retry_count) . '</td>';
        echo '<td><a href="?page=failed-webhooks&retry=' . esc_attr($webhook->id) . '" class="button">ç«‹å³é‡è¯•</a></td>';
        echo '</tr>';
    }

    echo '</table>';
}
```

#### ä¼˜ç‚¹
- âœ… ç®¡ç†å‘˜å¯æ‰‹åŠ¨é‡è¯• Webhookï¼Œç¡®ä¿æ”¯ä»˜ & é€€æ¬¾çŠ¶æ€æ›´æ–°

### ğŸ“Œ 5.6 Webhook å®‰å…¨éªŒè¯ï¼ˆé˜²æ­¢ä¼ªé€  & é‡æ”¾æ”»å‡»ï¼‰
#### é—®é¢˜
æ”»å‡»è€…å¯èƒ½ä¼ªé€  Webhook è¯·æ±‚ï¼Œç¯¡æ”¹æ”¯ä»˜/é€€æ¬¾çŠ¶æ€ã€‚

#### ä¼˜åŒ–æ–¹æ¡ˆ
- ä½¿ç”¨ HMAC - SHA256 è¿›è¡Œæ•°æ®ç­¾åéªŒè¯ï¼Œç¡®ä¿ Webhook æ¥æºçœŸå®ã€‚
- å¢åŠ æ—¶é—´æˆ³æ ¡éªŒï¼Œé˜²æ­¢ Webhook è¢«æ¶æ„é‡æ”¾ã€‚

#### **âœ… ä»£ç å®ç°**
```php
function verify_payment_signature($params, $received_signature) {
    $secret_key = get_option('payment_secret_key'); // ä»æ•°æ®åº“è·å–å¯†é’¥

    ksort($params);
    $query_string = http_build_query($params);
    $expected_signature = hash_hmac('sha256', $query_string, $secret_key);

    return hash_equals($expected_signature, $received_signature);
}

// åœ¨ Webhook å¤„ç†æ—¶è°ƒç”¨
$received_signature = $_POST['sign'] ?? '';

if (!verify_payment_signature($_POST, $received_signature)) {
    wp_die("ç­¾åéªŒè¯å¤±è´¥ï¼Œæ•°æ®å¯èƒ½è¢«ç¯¡æ”¹", "403 Forbidden", ['response' => 403]);
}
```

#### ä¼˜ç‚¹
- âœ… ç¡®ä¿ Webhook è¯·æ±‚æ¥æºçœŸå®ï¼Œé˜²æ­¢æ”¯ä»˜ & é€€æ¬¾æ•°æ®è¢«ä¼ªé€ 
- âœ… é˜²æ­¢ä¸­é—´äººæ”»å‡»ï¼ˆMITMï¼‰ï¼Œç¡®ä¿æ•°æ®å®Œæ•´æ€§

### 5.7 Webhook è¯¦ç»†æ—¥å¿—å¢å¼º & ç»“æ„åŒ–æ ¼å¼ä¼˜åŒ–
#### ç›®æ ‡
è®°å½•æ‰€æœ‰ Webhook è¯·æ±‚ & å“åº”ï¼Œæ–¹ä¾¿è°ƒè¯• & ç›‘æ§ï¼Œç¡®ä¿æ”¯ä»˜ & é€€æ¬¾è¿‡ç¨‹å¯è¿½æº¯ã€‚

## ğŸ“Œ 5.7.1 ç»“æ„åŒ–è®°å½• Webhook è¯·æ±‚
```php
function log_webhook_request($endpoint, $request_data) {
    $logger = wc_get_logger();
    
    $message = "[Webhook å›è°ƒ] [" . strtoupper($endpoint) . "]\n";
    $message .= "========================================\n";
    $message .= "è®¢å• ID: " . ($request_data['order_id'] ?? 'æœªçŸ¥') . "\n";
    $message .= "äº¤æ˜“å·: " . ($request_data['transaction_id'] ?? 'æœªçŸ¥') . "\n";
    $message .= "çŠ¶æ€: " . ($request_data['status'] ?? 'æœªçŸ¥') . "\n";
    $message .= "è¯·æ±‚æ—¶é—´: " . current_time('mysql') . "\n";
    $message .= "========================================\n";
    
    $logger->info($message, ['source' => 'wechat_alipay_webhook']);
}
```

## ä¼˜ç‚¹
- âœ… è®°å½• Webhook è¯¦ç»†æ—¥å¿—ï¼Œä¾¿äºè°ƒè¯•
- âœ… ç¡®ä¿ Webhook æ•°æ®å¯è¿½æº¯

---
 ## **6. ä¼˜åŒ– WooCommerce è®¢å•ç®¡ç†åå°çš„æ”¯ä»˜ & é€€æ¬¾äº¤äº’**  
> âœ… **ç›®æ ‡ï¼š**  
> 1. **ä¼˜åŒ–è®¢å•æ”¯ä»˜çŠ¶æ€ç®¡ç†**ï¼Œé˜²æ­¢ Webhook å¤±è´¥å¯¼è‡´è®¢å•çŠ¶æ€ä¸åŒæ­¥ã€‚  
> 2. **å¢å¼º WooCommerce è®¢å•åˆ—è¡¨ï¼Œç›´æ¥æ˜¾ç¤ºæ”¯ä»˜çŠ¶æ€ & äº¤æ˜“å·**ï¼Œæé«˜ç®¡ç†æ•ˆç‡ã€‚  
> 3. **æä¾›æ‰‹åŠ¨åŒæ­¥æ”¯ä»˜ & é€€æ¬¾çŠ¶æ€æŒ‰é’®**ï¼Œç¡®ä¿ç®¡ç†å‘˜å¯ä»¥æ‰‹åŠ¨ä¿®æ­£è®¢å•çŠ¶æ€ã€‚  
> 4. **å¢åŠ æ”¯ä»˜ & é€€æ¬¾ç»Ÿè®¡åŠŸèƒ½ï¼Œç®¡ç†å‘˜å¯æŸ¥çœ‹æ”¯ä»˜æˆåŠŸç‡ & é€€æ¬¾ç‡æ•°æ®ã€‚  

---

### **ğŸ“Œ 6.1 è®¢å•æ”¯ä»˜çŠ¶æ€ä¼˜åŒ–**
> **é—®é¢˜**ï¼šå¦‚æœ Webhook å¤±è´¥æˆ– WooCommerce æœªèƒ½æ­£ç¡®æ¥æ”¶æ”¯ä»˜çŠ¶æ€ï¼Œè®¢å•å¯èƒ½**ä»ç„¶æ˜¾ç¤ºâ€œå¾…æ”¯ä»˜â€**ï¼Œå¯¼è‡´**è®¢å•å¤„ç†å»¶è¯¯**ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
> - **åœ¨è®¢å•ç®¡ç†é¡µé¢æä¾›â€œåŒæ­¥æ”¯ä»˜çŠ¶æ€â€æŒ‰é’®**ï¼Œç®¡ç†å‘˜å¯æ‰‹åŠ¨æ›´æ–°æ”¯ä»˜çŠ¶æ€ã€‚  
> - **Ajax è½®è¯¢ WooCommerce APIï¼Œè‡ªåŠ¨æ›´æ–°è®¢å•æ”¯ä»˜çŠ¶æ€**ï¼Œå‡å°‘äººå·¥å¹²é¢„ã€‚  

#### **âœ… ä»£ç å®ç°**
```php
add_action('add_meta_boxes', 'add_payment_status_meta_box');
function add_payment_status_meta_box() {
    add_meta_box('payment_details_meta_box', 'æ”¯ä»˜ä¿¡æ¯', 'render_payment_details_meta_box', 'shop_order', 'side', 'default');
}

function render_payment_details_meta_box($post) {
    $order = wc_get_order($post->ID);
    $status = $order->get_status();

    echo '<p><strong>å½“å‰æ”¯ä»˜çŠ¶æ€ï¼š</strong> ' . esc_html($status) . '</p>';
    echo '<button id="sync_payment_status" class="button">åŒæ­¥æ”¯ä»˜çŠ¶æ€</button>';
    echo '<div id="sync_status_message" style="margin-top:10px;"></div>';

    ?>
    <script type="text/javascript">
        document.getElementById('sync_payment_status').addEventListener('click', function() {
            let orderId = <?php echo $post->ID; ?>;
            document.getElementById('sync_status_message').innerHTML = "æ­£åœ¨æ£€æŸ¥æ”¯ä»˜çŠ¶æ€...";

            fetch("<?php echo esc_url(home_url('/wp-json/wc/v3/orders/' . $post->ID)); ?>", {
                headers: { "Content-Type": "application/json" }
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('sync_status_message').innerHTML = "å½“å‰æ”¯ä»˜çŠ¶æ€ï¼š" + data.status;
            })
            .catch(error => {
                document.getElementById('sync_status_message').innerHTML = "åŒæ­¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ—¥å¿—ã€‚";
            });
        });
    </script>
    <?php
}
```
âœ… **ç®¡ç†å‘˜å¯æ‰‹åŠ¨åŒæ­¥æ”¯ä»˜çŠ¶æ€ï¼Œé˜²æ­¢ Webhook å¤±è´¥å¯¼è‡´è®¢å•çŠ¶æ€é”™è¯¯**  
âœ… **å‡å°‘äººå·¥å¹²é¢„ï¼Œç¡®ä¿ WooCommerce è®¢å•æ•°æ®å‡†ç¡®**  

---

### **ğŸ“Œ 6.2 é€€æ¬¾çŠ¶æ€ä¼˜åŒ–**
> **é—®é¢˜**ï¼šWooCommerce é€€æ¬¾çŠ¶æ€ä¾èµ– Webhook æ›´æ–°ï¼ŒWebhook å¤±è´¥æ—¶ï¼Œè®¢å•**å¯èƒ½ä»ç„¶æ˜¾ç¤ºâ€œå·²æ”¯ä»˜â€**ï¼Œå¯¼è‡´è´¢åŠ¡è®°å½•é”™è¯¯ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
> - **åœ¨ WooCommerce è®¢å•è¯¦æƒ…é¡µæ·»åŠ â€œåŒæ­¥é€€æ¬¾çŠ¶æ€â€æŒ‰é’®**ï¼Œç®¡ç†å‘˜å¯ä»¥æ‰‹åŠ¨æ›´æ–°è®¢å•é€€æ¬¾çŠ¶æ€ã€‚  

#### **âœ… ä»£ç å®ç°**
```php
add_action('add_meta_boxes', 'add_refund_status_meta_box');
function add_refund_status_meta_box() {
    add_meta_box('refund_status_meta_box', 'é€€æ¬¾çŠ¶æ€', 'render_refund_status_meta_box', 'shop_order', 'side', 'default');
}

function render_refund_status_meta_box($post) {
    $order = wc_get_order($post->ID);
    $status = $order->get_status();

    echo '<p id="refund_status">å½“å‰é€€æ¬¾çŠ¶æ€ï¼š' . esc_html($status) . '</p>';
    echo '<button id="sync_refund_status" class="button">åŒæ­¥é€€æ¬¾çŠ¶æ€</button>';
    echo '<div id="refund_sync_status" style="margin-top:10px;"></div>';

    ?>
    <script type="text/javascript">
        document.getElementById('sync_refund_status').addEventListener('click', function() {
            let orderId = <?php echo $post->ID; ?>;
            document.getElementById('refund_sync_status').innerHTML = "æ­£åœ¨æ£€æŸ¥é€€æ¬¾çŠ¶æ€...";

            fetch("<?php echo esc_url(home_url('/wp-json/wc/v3/orders/' . $post->ID)); ?>", {
                headers: { "Content-Type": "application/json" }
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('refund_status').innerHTML = "å½“å‰é€€æ¬¾çŠ¶æ€ï¼š" + data.status;
                document.getElementById('refund_sync_status').innerHTML = "åŒæ­¥å®Œæˆã€‚";
            })
            .catch(error => {
                document.getElementById('refund_sync_status').innerHTML = "åŒæ­¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ—¥å¿—ã€‚";
            });
        });
    </script>
    <?php
}
```
âœ… **ç®¡ç†å‘˜å¯ä¸€é”®åŒæ­¥é€€æ¬¾çŠ¶æ€ï¼Œç¡®ä¿ WooCommerce è®¢å•ä¸æ”¯ä»˜ç½‘å…³æ•°æ®ä¸€è‡´**  
âœ… **é˜²æ­¢ WooCommerce é€€æ¬¾çŠ¶æ€ä¸åŒæ­¥å¯¼è‡´çš„è´¢åŠ¡é”™è¯¯**  

---

### **ğŸ“Œ 6.3 è®¢å•ç®¡ç†ç•Œé¢ä¼˜åŒ–ï¼ˆå¢åŠ æ”¯ä»˜çŠ¶æ€ & äº¤æ˜“å·åˆ—ï¼‰**
> **é—®é¢˜**ï¼šWooCommerce è®¢å•åˆ—è¡¨**æ— æ³•ç›´æ¥æŸ¥çœ‹æ”¯ä»˜çŠ¶æ€ & äº¤æ˜“å·**ï¼Œç®¡ç†å‘˜éœ€è¦ç‚¹å‡»è®¢å•è¯¦æƒ…æ‰èƒ½çœ‹åˆ°æ”¯ä»˜ä¿¡æ¯ï¼Œå¢åŠ ç®¡ç†è´Ÿæ‹…ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
> - **åœ¨ WooCommerce è®¢å•åˆ—è¡¨é¡µæ–°å¢â€œæ”¯ä»˜çŠ¶æ€ & äº¤æ˜“å·â€åˆ—**ï¼Œæé«˜ç®¡ç†æ•ˆç‡ã€‚  

#### **âœ… ä»£ç å®ç°**
```php
add_filter('manage_edit-shop_order_columns', 'add_order_payment_status_column');
function add_order_payment_status_column($columns) {
    $columns['payment_status'] = 'æ”¯ä»˜çŠ¶æ€';
    $columns['transaction_id'] = 'äº¤æ˜“å·';
    return $columns;
}

add_action('manage_shop_order_posts_custom_column', 'fill_order_payment_status_column', 10, 2);
function fill_order_payment_status_column($column, $post_id) {
    if ($column == 'payment_status') {
        $order = wc_get_order($post_id);
        echo esc_html($order->get_status());
    }

    if ($column == 'transaction_id') {
        $transaction_id = get_post_meta($post_id, '_transaction_id', true);
        echo $transaction_id ? esc_html($transaction_id) : 'â€”';
    }
}
```
âœ… **WooCommerce è®¢å•åˆ—è¡¨é¡µç›´æ¥æ˜¾ç¤ºæ”¯ä»˜çŠ¶æ€ & äº¤æ˜“å·ï¼Œç®¡ç†å‘˜å¯å¿«é€Ÿç®¡ç†è®¢å•**  
âœ… **æ— éœ€è¿›å…¥è®¢å•è¯¦æƒ…é¡µï¼Œå³å¯æŸ¥çœ‹æ”¯ä»˜çŠ¶æ€ï¼Œæé«˜ç®¡ç†æ•ˆç‡**  

---

### **ğŸ“Œ 6.4 æ”¯ä»˜ & é€€æ¬¾ç»Ÿè®¡åŠŸèƒ½**
> **é—®é¢˜**ï¼šWooCommerce é»˜è®¤åå°**æ²¡æœ‰æ”¯ä»˜ & é€€æ¬¾æ•°æ®ç»Ÿè®¡**ï¼Œç®¡ç†å‘˜æ— æ³•æŸ¥çœ‹æ”¯ä»˜æˆåŠŸç‡ã€é€€æ¬¾ç‡ç­‰æ•°æ®ã€‚  
> **ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
- **å¢åŠ  WooCommerce è®¢å•ç»Ÿè®¡é¢æ¿**ï¼Œç®¡ç†å‘˜å¯æŸ¥çœ‹ï¼š  
  - **æ¯æ—¥/æ¯å‘¨æ”¯ä»˜æˆåŠŸç‡**ï¼ˆæŒ‰æ”¯ä»˜æ–¹å¼åˆ†ç±»ï¼‰ã€‚  
  - **æ”¯ä»˜å¤±è´¥ç‡ï¼ˆæŒ‰å¤±è´¥åŸå› åˆ†ç±»ï¼‰ã€‚**  
  - **é€€æ¬¾ç‡ & é€€æ¬¾é‡‘é¢å æ¯”ã€‚**  
- **æ”¯æŒå›¾è¡¨å¯è§†åŒ–å±•ç¤ºï¼ˆChart.js/Rechartsï¼‰ã€‚**  

#### **âœ… ä»£ç å®ç°**
```php
add_action('admin_menu', 'add_payment_statistics_page');
function add_payment_statistics_page() {
    add_submenu_page('woocommerce', 'æ”¯ä»˜ç»Ÿè®¡', 'æ”¯ä»˜ç»Ÿè®¡', 'manage_woocommerce', 'payment-statistics', 'render_payment_statistics_page');
}

function render_payment_statistics_page() {
    echo '<h2>æ”¯ä»˜ & é€€æ¬¾ç»Ÿè®¡</h2>';
    echo '<div id="payment-chart"></div>';
}
```
âœ… **æä¾› WooCommerce è®¢å•ç»Ÿè®¡å¯è§†åŒ–ç•Œé¢ï¼Œæ–¹ä¾¿ç®¡ç†å‘˜æŸ¥çœ‹æ”¯ä»˜ & é€€æ¬¾æ•°æ®ã€‚**  

---

 ## **7. æ–¹æ¡ˆæ€»ç»“ & æœªæ¥ä¼˜åŒ–æ–¹å‘**  

### **ğŸ“Œ 7.1 æ–¹æ¡ˆä¼˜åŒ–æ€»ç»“**
æœ¬æ–¹æ¡ˆå…¨é¢ä¼˜åŒ– WooCommerce åœ¨ WordPress å¤šç«™ç‚¹ï¼ˆMultisiteï¼‰ç¯å¢ƒä¸‹çš„**æ”¯ä»˜ & é€€æ¬¾ç®¡ç†**ï¼Œå®ç°äº†ä»¥ä¸‹æ”¹è¿›ï¼š  

| **åŠŸèƒ½** | **ä¼˜åŒ–å‰** | **ä¼˜åŒ–å** |
|------------|------------|------------|
| **æ”¯ä»˜æ–¹å¼ UI** | ä»…æ–‡æœ¬æ–¹å¼ï¼Œç”¨æˆ·ä¸æ˜“è¯†åˆ« | **æ·»åŠ æ”¯ä»˜æ–¹å¼å›¾æ ‡ï¼Œæå‡è¯†åˆ«åº¦** |
| **æ”¯ä»˜æˆåŠŸåçŠ¶æ€åé¦ˆ** | éœ€è¦æ‰‹åŠ¨åˆ·æ–°è®¢å•çŠ¶æ€ | **Ajax è½®è¯¢è‡ªåŠ¨æ£€æŸ¥æ”¯ä»˜çŠ¶æ€** |
| **æ”¯ä»˜å¤±è´¥ä½“éªŒ** | ä»…æç¤ºâ€œæ”¯ä»˜å¤±è´¥â€ | **æä¾›â€œé‡æ–°æ”¯ä»˜â€æŒ‰é’®ï¼Œå‡å°‘æµå¤±** |
| **é€€æ¬¾çŠ¶æ€æ›´æ–°** | ä¾èµ– Webhookï¼Œå¤±è´¥å¯èƒ½æ— æ³•æ›´æ–° | **æ”¯æŒç®¡ç†å‘˜æ‰‹åŠ¨åŒæ­¥é€€æ¬¾çŠ¶æ€** |
| **Webhook å¤±è´¥å¤„ç†** | Webhook å¤±è´¥åæ— è‡ªåŠ¨è¡¥æ•‘ | **å¤±è´¥è‡ªåŠ¨åŠ å…¥é˜Ÿåˆ—ï¼Œæœ€å¤šé‡è¯• 3 æ¬¡** |
| **Webhook æ‰‹åŠ¨é‡è¯•** | æ— æ³•æ‰‹åŠ¨é‡è¯• Webhook | **WooCommerce åå°æä¾› Webhook å¤±è´¥ç®¡ç†ç•Œé¢ï¼Œæ”¯æŒæ‰‹åŠ¨é‡è¯•** |
| **æ”¯ä»˜æ—¥å¿—ç®¡ç†** | æ‰€æœ‰å­ç«™å…±ç”¨æ—¥å¿—ï¼Œå¯èƒ½æœ‰æ•°æ®å®‰å…¨é—®é¢˜ | **æŒ‰ `site_id` è®°å½•æ—¥å¿—ï¼Œå­ç«™åªèƒ½æŸ¥çœ‹è‡ªå·±çš„æ”¯ä»˜è®°å½•** |
| **è®¢å•ç®¡ç†ç•Œé¢** | è®¢å•åˆ—è¡¨æ— æ”¯ä»˜çŠ¶æ€ & äº¤æ˜“å· | **åˆ—è¡¨é¡µæ–°å¢â€œæ”¯ä»˜çŠ¶æ€ & äº¤æ˜“å·â€åˆ—ï¼Œä¾¿äºç®¡ç†** |
| **çŸ­ä¿¡ & é‚®ä»¶é€šçŸ¥** | ä»…æ”¯æŒ WooCommerce é»˜è®¤é‚®ä»¶ | **æ–°å¢çŸ­ä¿¡é€šçŸ¥ï¼Œç”¨æˆ·æ”¯ä»˜/é€€æ¬¾åè‡ªåŠ¨æ”¶åˆ°æé†’** |
| **æ”¯ä»˜ & é€€æ¬¾ç»Ÿè®¡** | æ— æ³•æŸ¥çœ‹æ”¯ä»˜æˆåŠŸç‡ã€é€€æ¬¾ç‡ | **WooCommerce åå°æ–°å¢æ”¯ä»˜æ•°æ®ç»Ÿè®¡é¡µé¢ï¼Œæ”¯æŒå›¾è¡¨å±•ç¤º** |

---

### **ğŸ“Œ 7.2 æœªæ¥ä¼˜åŒ–æ–¹å‘**
æœ¬æ–¹æ¡ˆå·²ç»æ˜¾è‘—æå‡ WooCommerce å¤šç«™ç‚¹ç¯å¢ƒä¸‹çš„æ”¯ä»˜ & é€€æ¬¾ç®¡ç†ä½“éªŒï¼Œä½†æœªæ¥ä»å¯ä»¥ç»§ç»­ä¼˜åŒ–ä»¥ä¸‹æ–¹é¢ï¼š  

âœ… **1. Webhook å¤±è´¥åçš„è‡ªåŠ¨ API æŸ¥è¯¢åŠŸèƒ½**  
> **å½“å‰æ–¹æ¡ˆ**ï¼šWebhook å¤±è´¥åï¼Œç®¡ç†å‘˜å¯ä»¥æ‰‹åŠ¨è§¦å‘ API æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€ã€‚  
> **ä¼˜åŒ–æ–¹å‘**ï¼šWebhook å¤±è´¥ 3 æ¬¡åï¼ŒWooCommerce **è‡ªåŠ¨è°ƒç”¨ API æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€**ï¼Œå‡å°‘äººå·¥å¹²é¢„ã€‚  

âœ… **2. å…¼å®¹ WooCommerce è®¢é˜… & é¢„è®¢æ’ä»¶**  
> **å½“å‰æ–¹æ¡ˆ**ï¼šä»…ä¼˜åŒ–æ™®é€š WooCommerce è®¢å•æ”¯ä»˜ã€‚  
> **ä¼˜åŒ–æ–¹å‘**ï¼šå¢åŠ  WooCommerce Subscriptionsï¼ˆè®¢é˜…ï¼‰æ”¯æŒï¼Œç¡®ä¿è‡ªåŠ¨æ‰£æ¬¾ & ç»­è®¢è®¢å•çš„æ”¯ä»˜/é€€æ¬¾æµç¨‹æ— ç¼è¡”æ¥ã€‚  

âœ… **3. å¢åŠ æ”¯ä»˜è¶…æ—¶æé†’**  
> **å½“å‰æ–¹æ¡ˆ**ï¼šç”¨æˆ·æ”¯ä»˜é¡µé¢æ˜¾ç¤ºå€’è®¡æ—¶ï¼Œä½†ä¸ä¼šä¸»åŠ¨æé†’ã€‚  
> **ä¼˜åŒ–æ–¹å‘**ï¼šæ”¯æŒ**æ”¯ä»˜è¶…æ—¶å‰ 2 åˆ†é’Ÿå‘é€çŸ­ä¿¡æé†’**ï¼Œæé«˜æ”¯ä»˜æˆåŠŸç‡ã€‚  

âœ… **4. æ”¯æŒ PayPalã€Stripe ç­‰å›½é™…æ”¯ä»˜æ–¹å¼**  
> **å½“å‰æ–¹æ¡ˆ**ï¼šä»…æ”¯æŒå¾®ä¿¡æ”¯ä»˜ & æ”¯ä»˜å®ã€‚  
> **ä¼˜åŒ–æ–¹å‘**ï¼šæ‰©å±• Stripeã€PayPal æ”¯æŒï¼Œæ»¡è¶³å›½é™…å®¢æˆ·éœ€æ±‚ã€‚  

âœ… **5. å¢å¼ºå®‰å…¨æ€§ï¼ˆæ”¯ä»˜é˜²ç¯¡æ”¹ & è®¢å•é£é™©ç›‘æ§ï¼‰**  
> **å½“å‰æ–¹æ¡ˆ**ï¼šæä¾› Webhook å®‰å…¨éªŒè¯ï¼Œé˜²æ­¢ä¼ªé€ æ•°æ®ã€‚  
> **ä¼˜åŒ–æ–¹å‘**ï¼šå¢åŠ æ”¯ä»˜é£æ§æœºåˆ¶ï¼Œä¾‹å¦‚**IP è¿‡æ»¤ã€è®¾å¤‡æŒ‡çº¹è¯†åˆ«ã€å¼‚å¸¸æ”¯ä»˜æ£€æµ‹**ï¼Œè¿›ä¸€æ­¥æå‡æ”¯ä»˜å®‰å…¨æ€§ã€‚  

---
